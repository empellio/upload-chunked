<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Upload Chunked Example</title>
  </head>
  <body>
    <h1>Chunked Upload Demo</h1>
    <input type="file" id="file" />
    <button id="start">Start upload</button>
    <div id="progress">0%</div>
    <script type="module">
      import { client } from '../../dist/index.js'
      const fileInput = document.getElementById('file')
      const btn = document.getElementById('start')
      const progress = document.getElementById('progress')

      const uploader = client.createUploader({
        endpoint: '/upload',
        chunkSize: 5 * 1024 * 1024,
        concurrency: 3,
        storageKey: 'upload-state',
        checksum: 'sha256',
      })

      uploader.on('progress', (p) => (progress.textContent = `${p.percentage}%`))
      uploader.on('complete', (r) => console.log('Completed', r))
      uploader.on('error', (e) => console.error(e))

      btn.addEventListener('click', async () => {
        const file = fileInput.files[0]
        if (!file) return alert('Select a file')
        await uploader.upload(file, { fileId: `${Date.now()}` })
      })
    </script>
  </body>
</html>
